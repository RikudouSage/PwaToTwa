language: cpp
dist: bionic
compiler: gcc
services:
    - docker
script:
    - docker run --rm -it -v $(pwd):/app fffaraz/qt:static /bin/bash -c "cd /app/libgit && git submodule init && git submodule update && mkdir -p build && cd build && cmake -DBUILD_SHARED_LIBS=OFF -DBUILD_CLAR=OFF .. && cmake --build . && cd /app && qmake && make"
deploy:
    provider: releases
    api_key: $PWA_TO_TWA_ACCESS_KEY
    skip_cleanup: true
    file:
        - pwa-to-twa
    on:
        tags: true
branches:
    only:
        - /^v\d+\.\d+(\.\d+)?(-\S*)?$/

